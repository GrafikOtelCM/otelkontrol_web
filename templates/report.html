{% extends 'base.html' %}
{% block content %}
<div class="container my-5">
  <h2 class="text-center mb-4"><i class="bi bi-clipboard-data"></i> Rapor Sayfası</h2>

  {% if mismatched_phones %}
    <div class="card shadow mb-4">
      <div class="card-header bg-danger text-white fw-bold">📞 Telefon Numarası Uyuşmayanlar</div>
      <div class="card-body">
        <table id="phoneMismatchTable" class="table table-bordered table-striped">
          <thead><tr><th>Otel Adı</th><th>Excel Telefon</th><th>Google Telefon</th></tr></thead>
          <tbody>
            {% for row in mismatched_phones %}
              <tr><td>{{ row.name }}</td><td>{{ row.excel }}</td><td>{{ row.google }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  {% endif %}

  {% if no_website_hotels %}
    <div class="card shadow mb-4">
      <div class="card-header bg-warning fw-bold">🌐 Web Sitesi Olmayan Oteller</div>
      <div class="card-body">
        <table id="noWebsiteTable" class="table table-bordered table-striped">
          <thead><tr><th>Otel Adı</th><th>Telefon</th></tr></thead>
          <tbody>
            {% for row in no_website_hotels %}
              <tr><td>{{ row.name }}</td><td>{{ row.phone }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  {% endif %}

  {% if matched_records %}
    <div class="card shadow">
      <div class="card-header bg-success text-white fw-bold">✅ Doğru Kayıtlar</div>
      <div class="card-body">
        <table id="matchedTable" class="table table-bordered table-striped">
          <thead><tr><th>Otel Adı</th><th>Telefon</th><th>Place ID</th></tr></thead>
          <tbody>
            {% for row in matched_records %}
              <tr><td>{{ row.name }}</td><td>{{ row.phone }}</td><td>{{ row.place_id }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    $(document).ready(function () {
      $('#phoneMismatchTable').DataTable({ dom: 'Bfrtip', buttons: ['copy', 'excel', 'pdf', 'print'], language: { url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/tr.json' } });
      $('#noWebsiteTable').DataTable({ dom: 'Bfrtip', buttons: ['copy', 'excel', 'pdf', 'print'], language: { url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/tr.json' } });
      $('#matchedTable').DataTable({ dom: 'Bfrtip', buttons: ['copy', 'excel', 'pdf', 'print'], language: { url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/tr.json' } });
    });
  </script>
{% endblock %}
